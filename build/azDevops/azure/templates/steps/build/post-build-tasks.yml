parameters:
  project_root_dir: ""
  functional_test: ""
  functional_test_path: ""
  functional_test_artefact: ""
  build_file: ""
  build_file_path: ""
  build_file_artefact: ""

steps:
  - task: PublishTestResults@2
    condition: always()
    displayName: "Publish Test Results"

  - task: PublishCodeCoverageResults@1
    condition: always()
    inputs:
      codeCoverageTool: "JaCoCo"
      summaryFileLocation: "${{ parameters.project_root_dir }}/target/site/jacoco/jacoco.xml"
      reportDirectory: "${{ parameters.project_root_dir }}/target/site/jacoco-inline"
    displayName: "Publish JaCoCo Coverage Results"

  # Publish Artefacts if required
  - ${{ if eq(parameters.functional_test, true) }}:
      - task: PublishPipelineArtifact@1
        inputs:
          path: "${{ parameters.functional_test_path }}"
          artifact: "${{ parameters.functional_test_artefact }}"
        displayName: "Publish: Functional Tests Artifact"

  - ${{ if eq(parameters.build_file, true) }}:
      - task: PublishPipelineArtifact@1
        inputs:
          path: "${{ parameters.build_file_path }}"
          artifact: "${{ parameters.build_file_artefact }}"
        displayName: "Publish: Build Artefacts"
